---
title: How To Make Your VIM Speak?
date: 2010-05-01
category: programming
layout: post
status: draft
---


Today I wrote some code to make [Vim](http://www.vim.org/) speaks using python and TTS.

If you are interested, install [pyttsx](https://pypi.python.org/pypi/pyttsx), and paste the code snippet to your `.vimrc` file.



    :::python
    function! Speak()
    python << EOF
    import vim
    l = vim.current.line
    w = vim.current.window
    row, col = w.cursor
    if l[col] == " ":
        print "No word under cursor"
    else:
        p_end = l.find(" ", col + 1)
        if p_end < 0:
            p_end = l.find("\t", col + 1)
        if p_end >= 0:
            l = l[:p_end]
        words = l.split()
        w = words[-1]
    
        if w:
            import pyttsx
            engine = pyttsx.init('sapi5')
            voices = engine.getProperty('voices')
            good_voice = voices[-1]
            engine.setProperty('voice', good_voice.id)
            engine.say(w)
            engine.runAndWait()
    EOF
    endfunction
