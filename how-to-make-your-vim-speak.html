
<!DOCTYPE html>
<html lang="en">
<head>
<title>How To Make Your VIM Speak? - Xing Shi Cai/蔡醒诗</title>

    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans:regular,bold">
    <link rel="stylesheet" type="text/css" href="https://newptcai.github.io/theme/css/w3.css">
    <link rel="stylesheet" type="text/css" href="https://newptcai.github.io/theme/css/style.css">
    <link rel="stylesheet" type="text/css" href="https://newptcai.github.io/theme/css/jqcloud.css">
    <link rel="stylesheet" type="text/css" href="https://newptcai.github.io/theme/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="https://newptcai.github.io/theme/css/shariff.min.css">
    <link rel="stylesheet" type="text/css" href="https://newptcai.github.io/theme/css/pygments-highlight-github.css">

    <!-- JavaScript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="https://newptcai.github.io/theme/js/jqcloud.min.js"></script>

     <!-- Meta -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="HandheldFriendly" content="True" />

    <meta name="author" content="Xing Shi Cai" />
    <meta name="description" content="Today I wrote some code to make Vim speaks using python and TTS. If you are interested, install pyttsx, and …" /> 
    <meta name="keywords" content=""> 

    <!-- Facebook OpenGraph -->
    <meta property="og:site_name" content="Xing Shi Cai/蔡醒诗">
    <meta property="og:title" content="How To Make Your VIM Speak? - Xing Shi Cai/蔡醒诗" />
    <meta property="og:description" content="Today I wrote some code to make Vim speaks using python and TTS. If you are interested, install pyttsx, and …" />
    <meta property="og:image" content="https://newptcai.github.io">
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://newptcai.github.io/how-to-make-your-vim-speak.html" />
    <meta property="og:locale" content="de_DE" />
    <meta property="og:locale:alternate" content="en_US" />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="How To Make Your VIM Speak? - Xing Shi Cai/蔡醒诗">
    <meta name="twitter:description" content="Today I wrote some code to make Vim speaks using python and TTS. If you are interested, install pyttsx, and …">
    <meta name="twitter:image" content="https://newptcai.github.io">
</head>
<body>
  <div class="w3-row w3-card w3-white">
    <header id=banner>
       <!-- AUTHOR INITIALS-->
      <a href="https://newptcai.github.io" id=logo title="Home">XS</a>
      <nav id="menu">
        <ul>
          <li><a href="https://newptcai.github.io/pages/research.html">Research</a></li>
          <li><a href="https://newptcai.github.io/pages/teaching.html">Teaching</a></li>
          <li ><a href="https://newptcai.github.io/category/math.html">math</a></li>
          <li ><a href="https://newptcai.github.io/category/photo.html">photo</a></li>
          <li style="font-weight: bold;"><a href="https://newptcai.github.io/category/programming.html">programming</a></li>
        </ul>
      </nav>
    </header>
  </div>
<br>
<article>
  <header class="w3-container col-main">
    <h1>How To Make Your VIM Speak?</h1>
    <div class="post-info">
      <div class="w3-opacity w3-margin-right w3-margin-bottom" style="flex-grow: 1;">
        <span>  Posted on Sat 01 May 2010 in <a href="https://newptcai.github.io/category/programming.html" style="font-style: italic">programming</a>

        </span>
      </div>
    </div>
  </header>
  <br>
  <div class="col-main w3-container">
    <main id="article-content">
      <p>Today I wrote some code to make <a href="http://www.vim.org/">Vim</a> speaks using python and TTS.</p>
<p>If you are interested, install <a href="https://pypi.python.org/pypi/pyttsx">pyttsx</a>, and paste the code snippet to your <code>.vimrc</code> file.</p>
<div class="highlight"><pre><span></span><span class="n">function</span><span class="err">!</span> <span class="n">Speak</span><span class="p">()</span>
<span class="n">python</span> <span class="o">&lt;&lt;</span> <span class="n">EOF</span>
<span class="kn">import</span> <span class="nn">vim</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">vim</span><span class="o">.</span><span class="n">current</span><span class="o">.</span><span class="n">line</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">vim</span><span class="o">.</span><span class="n">current</span><span class="o">.</span><span class="n">window</span>
<span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">cursor</span>
<span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot; &quot;</span><span class="p">:</span>
    <span class="nb">print</span> <span class="s2">&quot;No word under cursor&quot;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">p_end</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">p_end</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">p_end</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">p_end</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">l</span><span class="p">[:</span><span class="n">p_end</span><span class="p">]</span>
    <span class="n">words</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">w</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">pyttsx</span>
        <span class="n">engine</span> <span class="o">=</span> <span class="n">pyttsx</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="s1">&#39;sapi5&#39;</span><span class="p">)</span>
        <span class="n">voices</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">getProperty</span><span class="p">(</span><span class="s1">&#39;voices&#39;</span><span class="p">)</span>
        <span class="n">good_voice</span> <span class="o">=</span> <span class="n">voices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">engine</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s1">&#39;voice&#39;</span><span class="p">,</span> <span class="n">good_voice</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="n">engine</span><span class="o">.</span><span class="n">say</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
        <span class="n">engine</span><span class="o">.</span><span class="n">runAndWait</span><span class="p">()</span>
<span class="n">EOF</span>
<span class="n">endfunction</span>
</pre></div>
    </main>
    <br>
    <footer>
      <div class="adjust-width">
        <div id="author-block" class="w3-light-grey w3-border">
            <img style="width: 35px; height: 56px; margin-left:50px;" src="https://newptcai.github.io/theme/images/bookmark-red.png" alt="bookmark"></img>
            <div id="author-info">
                <a href="https://newptcai.github.io/authors.html#xing-shi-cai"><img
                   style="width: 60px; height: 60px;" src="https://newptcai.github.io/authors/xing-shi-cai.png" onerror="this.src='https://newptcai.github.io/theme/images/avatar.png'"></img>
                </a>
                <div style="margin-left: 20px; margin-top: 15px;">
                    <a href="https://newptcai.github.io/authors.html#xing-shi-cai"><span id="author-name" class="w3-hover-text-dark-grey">Xing Shi Cai</span></a>
                    <p id="author-story" style="max-width: 500px;"></p>
                </div>
            </div>
        </div>
      </div>
      <br>
    </footer>
  </div>
</article>
<br>
<script src="https://newptcai.github.io/theme/js/shariff.min.js"></script>
</body>
</html>