---
title: The Convexity Property Related to Beta Densities
date: 2018-12-01
layout: post
tags: real-analysis, probability, beta-distribution, Mathematica, CAS
status: published
---

![Density function of Beta\[3,7\]]({static}/images/2018-12-01-beta/beta-density.png)

*(This is a question asked by [Tilo Wiklund](https://katalog.uu.se/profile/?id=N15-1140) recently on our group meeting.)*

<!-- END_SUMMARY -->

## The problem

A [Beta distribution](https://en.wikipedia.org/wiki/Beta_distribution) with parameters ($\alpha$,$\beta$) has the density function
$$ 
f(x;\alpha,\beta) = \frac{x^{\alpha -1} (1-x)^{\beta -1}}{B(\alpha ,\beta )}, \qquad x \in
[0,1]
$$
As shown in the above picture, the density of this function, is concave, not convex. So you may think there is a mistake in
the title.

No, actually we are going to talk a related function $r(x)$ constructed from $f(x)$. Let $m$ be the
point where $f(x)$ reaches maximum. With a bit calculus, we have
$$
m=\frac{\alpha -1}{\alpha +\beta -2}.
$$
(So in the above example, we have $m=1/4$, which can also be seen from the picture.)
Let $f^{-1}_{1}$ and $f^{-1}_{2}$ be the inverse of $f(x)$ for $x \in (0,m)$ and $x \in (m,1)$
respectively. They would look like this
![The inverse of the density function of Beta\[3,7\]]({static}/images/2018-12-01-beta/beta-density-inverse.png)
Then we define this function
$$
r(x)
=
\begin{array}{cc}
\left\{ 
\begin{array}{cc}
 f^{-1}_{2} (f1(x)) & x \in (0,m) \\
 f^{-1}_{1} (f1(x)) & x \in [m,1) \\
\end{array}
\right.
 \\
\end{array}
$$
What does this weird function do? It takes one point $x \in [0,1]$, and gives you the point $r(x)
\in [0,1]$, such that $f(x)=f(r(x))$ and $x \ne r(x)$. In other words, it reflects the point $x$
through the curve of beta density.

![r\[x\] reflects x through the density function of Beta\[3,7\]]({static}/images/2018-12-01-beta/beta-density-reflect.png)

So what is the conjecture? Tilo suggests that if $\beta>\alpha>1$, then $r(x)$ must be convex. This
looks reasonable if you look at the picture.

![r\[x\] for the density function of Beta\[3,7\]]({static}/images/2018-12-01-beta/beta-density-r.png)

## How to prove it?

This is not an easy question as it seems. The main difficulty is that we do not how to inverse
$x^{\alpha-1}(1-x)^{\beta-1}$. So if we take second derivative of $r(x)$, using the formula
$$
\frac{
\mathrm d
}
{
\mathrm d x
}
f^{-1}(x)
=
\frac{1}
{
f'(f^{-1}(x))
}
,
$$
we get a bit chunk of mess.

Fortunately we live in 2018 and we have computers to help us. Yes, $r''(x)$ is very ugly. But with
the help of computer, it is not to difficult to see that when $\beta>\alpha>1$, $r''(x)>0$ is
equivalent to the following, very simple inequality
$$
x + r(x) \ge 2 m.
$$

Look at the picture again and it won't take you long to convince yourself that this is true.
![r\[x\] reflects x through the density function of Beta\[3,7\]]({static}/images/2018-12-01-beta/beta-density-reflect.png)
In this case $m$ at most $1/2$. So when $x=0$, the left hand side is $1> 2m$. And when $x=r(x)=m$,
we have equality.

Now note that for $x \leq m$,
$$
x+r(x)\geq 2 m\Leftrightarrow {f_2^{-1}}(f(x))+x\geq 2 m\Leftrightarrow {f_2^{-1}}(f(x))\geq 2 m-x
$$

![The inverse of the density function of Beta\[3,7\]]({static}/images/2018-12-01-beta/beta-density-inverse.png)

Looking at the picture of $f^{-1}(x)$ again, we see that ${f_2^{-1}}$ is decreasing.
Therefore, we only need to prove that
$$
f(x) \le f(2m - x), \qquad x \in (0,m).
$$
The nice thing about this inequality is that all the inverse functions are gone!

As mathematicians often like say when they run out of time, "the rest is left as an exercise"! (Or if
you have Mathematica install, you can have a look of my [somewhat messy code]({static}/doc/beta-2.nb) and check the details.)
